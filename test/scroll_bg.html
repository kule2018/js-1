<!DOCTYPE html>
<html>
    <head>
        <title>一个滚动视差效果</title>
        <meta name="viewport" content="width=device-width,initial-scale=0.5,user-scalable=no" />
        <style>
            *
            {
                padding: 0;
                margin: 0;
            }


            #scrollbox
            {
                --scroll-top: 0;
                --rate: 2;
            }


            section
            {
                height: 100vh;
                background: center fixed;
                background-size: auto 200%;
                display: flex;
                justify-content: center;
                align-items: center;
            }


            section:nth-of-type(1)
            {
                background-image: url(../img/1.jpg);
                background-position: center calc(var(--scroll-top) * 1px / var(--rate));
            }


            section:nth-of-type(2)
            {
                background-image: url(../img/2.jpg);
                background-position: center calc(var(--scroll-top) * 1px / var(--rate));
            }


            section:nth-of-type(3)
            {
                background-image: url(../img/3.jpg);
                background-position: center calc((var(--scroll-top) * 1px + 100vh) / var(--rate));
            }


            section:nth-of-type(4)
            {
                background-image: url(../img/4.jpg);
                background-position: center calc((var(--scroll-top) * 1px + 200vh) / var(--rate));
            }


            section:nth-of-type(5)
            {
                background-image: url(../img/5.jpg);
                background-position: center calc((var(--scroll-top) * 1px + 300vh) / var(--rate));
            }


            section > p
            {
                width: 50%;
                background: rgba(0, 0, 0, 0.5);
                padding: 10px;
                color: #fff;
                line-height: 1.5;
                font-size: 18px;
            }

        </style>
    </head>
    <body>
        <div id="scrollbox">
            <section>
                <p>
                    SGML 即Standard Globalized Markup Language 是用来定义标准的标记语言，简单的说，就是定义文档的元语言。
                    HTML 是基于SGML 的超链接语言，可以用于创建Web页面。在DTD 内部定义了标签的规则，DTD就是使用SGML 语言创建的。
                    XML 是从SGML 衍生而来的，它主要处理互联网方面的需求，HTML 有很多限制，XML 是SGML 的子集，可用于表示数据。
                </p>
            </section>
            <section>
                <p>
                    这句代码简单的介绍了HTML 版本号，有了Doctype，就引入了对应的DTD（定义了HTML文档的组织结构），在页面中添加的所有标签才会是合法的，简单的说DTD 就是定义HTML的语法规则。
                    即使在没有引入DTD的情况下，很多浏览器也可以识别HTML元素，因为它们自身包含对HTML 元素的定义，这就是为什么很多开发人员没有感受到DTD 的存在。
                </p>
            </section>
            <section>
                <p>
                    HTML5不是基于SGML 语言的，因此不需要DTD ，它是一种全新的标记语言，有自己的解析规则，HTML5的语法规则与之前版本有很大的差别，可以称的上是一种全新的语言。
                    HTML5 的Doctype 非常简单
                </p>
            </section>
            <section>
                <p>
                    event.preventDefault(); 会组织默认行为的发生，将错误信息置顶event.srcElement；获取包含非法值的控件，如上的Email textbox;element.validity; 包含控件的验证信息，如valueMissing，typeMismatch，badInput等。
                </p>
            </section>
            <section>
                <p>
                    SGML 即Standard Globalized Markup Language 是用来定义标准的标记语言，简单的说，就是定义文档的元语言。
                    HTML 是基于SGML 的超链接语言，可以用于创建Web页面。在DTD 内部定义了标签的规则，DTD就是使用SGML 语言创建的。
                    XML 是从SGML 衍生而来的，它主要处理互联网方面的需求，HTML 有很多限制，XML 是SGML 的子集，可用于表示数据。
                </p>
            </section>
        </div>
        <script type="text/javascript" src="https://soneway.github.io/js/query.js"></script>
        <script type="text/javascript" src="https://soneway.github.io/jq/jq.js"></script>
        <script type="text/javascript">
            var bodyEl = document.body,
                scrollboxEl = document.getElementById('scrollbox');
            if (query.getItem('new')) {
                $(window).on('scroll', function () {
                    var scrollTop = bodyEl.scrollTop;
                    scrollboxEl.style.setProperty('--scroll-top', -scrollTop);
                }).trigger('scroll');
            }
            else {
                var $sections = $('section'),
                    rsStyle = getComputedStyle(scrollboxEl),
                    rate = +rsStyle.getPropertyValue('--rate') || 5,
                    winHeihgt = window.innerHeight;
                $(window).on('scroll', function () {
                    var scrollTop = bodyEl.scrollTop;
                    $sections.each(function (i) {
                        var bgTop = -(scrollTop - winHeihgt * (i - 1)) / rate;
                        bgTop < 0 && $(this).css('background-position', 'center ' + bgTop + 'px')
                    });
                }).trigger('scroll');
            }
        </script>
    </body>
</html>
